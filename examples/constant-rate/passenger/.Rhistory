dis(P)
dis(Q)
dis(c(P,Q))
P <- c(15, 13, 11, 10)
Q <- c(10, 10, 10, 10)
dis(P)
dis(Q)
dis(c(P,Q))
Q <- c(10, 10, 11, 10)
dis(P)
dis(Q)
dis(c(P,Q))
dis(P) + dis(Q)
dis(c(P,Q)) / (dis(P) + dis(Q))
Q <- c(10, 10, 10, 10)
dis(P)
dis(Q)
dis(c(P,Q)) / (dis(P) + dis(Q))
dis(c(P,Q))
dis(P)
dis(Q)
dis(c(P,Q)) / (dis(P) + dis(Q))
dis(x1)
dis(x2)
norm2(P - (P %*% ones) / (ones %*% ones) * ones)
dis(x1)
x1 - mean(x1)
(x1 - mean(x1))^2
(x1 - mean(x1))^2
x1
x1 <- rnorm(2, 10, 2)
x1
(x1 - mean(x1))^2
mean(x1)
x1 <- rnorm(4, 10, 2)
x1
(x1 - mean(x1))^2
sqrt(sum((x1 - mean(x1))^2))
dis(x1)
dis <- function(x) sqrt(sum((x - mean(x))^2))
dis(c(x1, x2))
dis(x1)^2 + dis(x2)^2
dis(P)
x1 <- rnorm(2, 10, 2)
x2 <- rnorm(2, 10, 1)
x <- c(x1, x2)
y <- x(x1, c(10, 10)
)
y <- c(x1, c(10, 10))
x
dis(x)
dis(x1)
dis(x2)
dis(x)
dis(y)
x1
x2
x
y
dis(x1)
dis(x2)
dis(x)
dis(y)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(y)^2
dis(x1)^2
dis(x2)^2
dis(x1)^2 + dis(x2)^2
dis(x)^2
dis(x)^2 / sum(dis(x1)^2 + dis(x2)^2)
dis(y)^2 / sum(dix(x1)^2)
dis(y)^2 / sum(dis(x1)^2)
dis(x)^2 / sum(dis(x1)^2 + dis(x2)^2)
dis(y)^2 / sum(dis(x1)^2)
x1 <- rnorm(2, 10, 4)
x2 <- rnorm(2, 10, 1)
x <- c(x1, x2)
y <- c(x1, c(10, 10))
dis(x)^2 / sum(dis(x1)^2 + dis(x2)^2)
dis(y)^2 / sum(dis(x1)^2)
x1 <- rbeta(2, 1, 1)
x1
x2 <- rnorm(2, 100, 100)
x2
x2 <- rbeta(2, 100, 100)
x2
x1 <- rbeta(2, 1, 1)
x2 <- rbeta(2, 100, 100)
x <- c(x1, x2)
y <- c(x1, c(10, 10))
dis(x1)
dis(x2)
x1 <- rbeta(2, 1, 1)
x2 <- rbeta(2, 100, 100)
x <- c(x1, x2)
y <- c(x1, c(10, 10))
dis(x)
y <- c(x1, c(0.1,0.1))
dis(x1)
dis(x2)
dis(x)
y <- c(x1, c(0.5,0.5))
dis(x1)
dis(x2)
dis(x)
dis(y)
y <- c(x1, c(0.1,0.1))
dis(y)
x2 <- rbeta(2, 100, 100)
x3 <- rbeta(2, 100, 100)
x <- c(x1, x2)
x <- c(x1, x2)
y <- c(x2, x3)
dis(x1)
dis(x2)
dis(x)
dis(y)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(y)^2
dis(x1 + x2)
dis(x1)^2 + dis(x2)^2
dis(x3)^2
dis(x2)^2
dis(y)^2
dis(x3)^2 + dis(x2)^2
dis(x)^2 / dis(x1)^2 + dis(x2)^2
dis(y)^2 / dis(x3)^2 + dis(x2)^2
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x)^2 / dis(x1)^2 + dis(x2)^2
dis(x3)^2
dis(x2)^2
dis(y)^2
dis(y)^2 / dis(x3)^2 + dis(x2)^2
x1 <- rbeta(10, 1, 1)
x2 <- rbeta(10, 100, 100)
x3 <- rbeta(10, 100, 100)
x <- c(x1, x2)
y <- c(x2, x3)
dis(x)^2 / dis(x1)^2 + dis(x2)^2
dis(y)^2 / dis(x3)^2 + dis(x2)^2
y
dis(x1)^2
dis(x2)^2
dis(x3)^2
dis(x2)^2
dis(x)^2
dis(y)^2
dis(x1)^2 + dis(x2)^2
dis(x3)^2 + dis(x2)^2
dis(x1)^2 + dis(x2)^2
dis(x)^2
dis(x)^2 / dis(x1)^2 + dis(x2)^2
dis(y)^2
dis(x3)^2 + dis(x2)^2
dis(y)^2 / dis(x3)^2 + dis(x2)^2
dis(x)^2 / (dis(x1)^2 + dis(x2)^2)
dis(y)^2 / (dis(x3)^2 + dis(x2)^2)
x1 <- rbeta(2, 1, 1)
x2 <- rbeta(2, 100, 100)
x3 <- rbeta(2, 100, 100)
x <- c(x1, x2)
y <- c(x2, x3)
dis(x)^2 / (dis(x1)^2 + dis(x2)^2)
dis(y)^2 / (dis(x3)^2 + dis(x2)^2)
x1 <- rbeta(5, 1, 1)
x2 <- rbeta(5, 100, 100)
x3 <- rbeta(5, 100, 100)
x <- c(x1, x2)
y <- c(x2, x3)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x)^2 / (dis(x1)^2 + dis(x2)^2)
dis(x3)^2
dis(x2)^2
dis(y)^2
dis(y)^2 / (dis(x3)^2 + dis(x2)^2)
x1 <- c(0,0)
x2 <- c(1,1)
dis(x)^2 / (dis(x1)^2 + dis(x2)^2)
x3 <- c(1,1)
x <- c(x1, x2)
y <- c(x2, x3)
x <- c(x1, x2)
y <- c(x2, x3)
dis(x)^2
dis(x)^2 / (dis(x1)^2 + dis(x2)^2)
dis(y)^2
dis(y)^2 / (dis(x3)^2 + dis(x2)^2)
x3 <- c(1,1)
dis(x3)^2
dis(x2)^2
dis(y)^2
dis(y)^2
dis(x)^2
dis(x1)^2
dis(x2)^2
dis(x3)^2
x3 <- c(0,0,1,1)
dis(x3)^2
x1 <- c(0.01,.01)
x2 <- c(0.9,0.9)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x3)^2
x1 <- c(0.4,0.4)
x2 <- c(0.5,0.5)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x3)^2
dis(x)^2 / (dis(x1)^2 + dis(x2)^2)
x1 <- c(0.41,0.39)
x2 <- c(0.51,0.52)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x3)^2
dis(x)^2 / (dis(x1)^2 + dis(x2)^2)
dis(x3)^2
dis(x)^2
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x)^2 / (dis(x1)^2 + dis(x2)^2)
dis(x) / sqrt(dis(x1)^2 + dis(x2)^2)
x1 <- c(0.4,0.4)
x2 <- c(0.51,0.52)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x) / sqrt(dis(x1)^2 + dis(x2)^2)
x1 <- c(0.48,0.49)
x2 <- c(0.51,0.52)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x) / sqrt(dis(x1)^2 + dis(x2)^2)
x1 <- c(0.5,0.45)
x2 <- c(0.51,0.52)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x) / sqrt(dis(x1)^2 + dis(x2)^2)
x1 <- rnorm(10, 0.5, 0.001)
x2 <- rnorm(10, 0.4, 0.001)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x) / sqrt(dis(x1)^2 + dis(x2)^2)
x2 <- rnorm(10, 0.4, 0.01)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x) / sqrt(dis(x1)^2 + dis(x2)^2)
x
x1
x2
x1 <- rnorm(10, 0.5, 0.001)
x2 <- rnorm(10, 0.5, 0.01)
x <- c(x1, x2)
dis(x1)^2
dis(x2)^2
dis(x)^2
dis(x) / sqrt(dis(x1)^2 + dis(x2)^2)
x2
x1
dis(x1)^2)
dis(x1)^2
dis(x1)^2 / dis(x2)^2
?rf
qf(0.025, 2, 2)
qf(0.025, 1, 1)
qf(0.975, 1, 1)
x1 <- rnorm(10, 0.5, 0.001)
x2 <- rnorm(10, 0.5, 0.01)
x1
x2
dis(x1)^2 / dis(x2)^2
F.test
f.test
ftest
Ftest
levene.test
??levene
levene.test
library(Rcmdr)
?leveneTest
library(car)
install.packages('car')
x <- c(5, 9)
x - mean(x)
(x - mean(x))^2
sum((x - mean(x))^2)
sqrt(sum((x - mean(x))^2))
dis(x)
dis <- function(P){
ones <- rep(1, length(P))
norm2(P - (P %*% ones) / (ones %*% ones) * ones)
}
dis(x)
dis
dis(X)
dis(x)
sqrt(sum((x - mean(x))^2))
x <- rnorm(100, 5, 1)
hist(x)
library(ggplot2)
qplot(x, geom = "density")
qplot(exp(x), geom =  "density")
rho = 1
qplot(exp(x+1), geom =  "density")
qplot(exp(x), geom =  "density")
qplot(exp(x+1), geom =  "density")
x <- c(9, 3, 5)
sum((x - mean(x))^2)
dis <- function(x){
sqrt(sum(x^2))
}
dis(c(1, 1, 1, 1))
dis(c(1, 1)
)
dis(c(1, 0))
dis(rep(1, length(x))
rep(1, length(x)) / dis(rep(1, length(x)))
x - x %*% rep(1, length(x)) / dis(rep(1, length(x))) * x
dis(x - x %*% rep(1, length(x)) / dis(rep(1, length(x))) * x)
sqrt(dis(x - x %*% rep(1, length(x)) / dis(rep(1, length(x))) * x))
rep(1, length(x)) / dis(rep(1, length(x)))
rep(1, length(x)) / norm(rep(1, length(x)))
norm2 <- function(x){
sqrt(sum(x^2))
}
rep(1, length(x)) / norm2(rep(1, length(x)))
x %*% rep(1, length(x)) / norm2(rep(1, length(x)))
x
x %*% rep(1, length(x)) / norm2(rep(1, length(x))) * x
x - x %*% rep(1, length(x)) / norm2(rep(1, length(x))) * x
norm2(x - x %*% rep(1, length(x)) / norm2(rep(1, length(x))) * x)
x - x %*% rep(1, length(x)) / norm2(rep(1, length(x)))
norm2(x - x %*% rep(1, length(x)) / norm2(rep(1, length(x))))
sum((x - mean(x))^2)
x <- c(9, 3)
sum((x - mean(x))^2)
norm2(x - x %*% rep(1, length(x)) / norm2(rep(1, length(x))))
norm2(x - x %*% rep(1, length(x)) / norm2(rep(1, length(x)))*x)
sqrt(norm2(x - x %*% rep(1, length(x)) / norm2(rep(1, length(x)))*x))
rep(1, length(x))
norm2(rep(1, length(x)))
rep(1, length(x)) / norm2(rep(1, length(x)))
x %*% rep(1, length(x)) / norm2(rep(1, length(x)))
x %*% rep(1, length(x)) / norm2(rep(1, length(x))) * rep(1, length(x))
x - x %*% rep(1, length(x)) / norm2(rep(1, length(x))) * rep(1, length(x))
norm2(x - x %*% rep(1, length(x)) / norm2(rep(1, length(x))) * rep(1, length(x)))
sum((x - mean(x))^2)
sqrt(sum((x - mean(x))^2))
x <- c(9, 3)
sqrt(sum((x - mean(x))^2))
norm2(x - x %*% rep(1, length(x)) / norm2(rep(1, length(x))) * rep(1, length(x)))
norm2 <- function(x){
sqrt(sum(x^2))
}
x <- c(9, 3)
(x - mean(x))^2
(x - mean(x))
sum((x - mean(x))^2)
sqrt(sum((x - mean(x))^2))
x %*% ones
ones <- rep(1, length(x))
x %*% ones
(ones %*% ones)
x - x %*% ones / (ones %*% ones) * ones
norm2(x - x %*% ones / (ones %*% ones) * ones))
norm2(x - x %*% ones / (ones %*% ones) * ones)
sqrt(sum((x - mean(x))^2))
norm2(x - x %*% ones / norm2(ones)^2 * ones)
x <- rnorm(10, 10, 2)
sqrt(sum((x - mean(x))^2))
ones <- rep(1, length(x))
norm2(x - x %*% ones / norm2(ones)^2 * ones)
install_github("chrisamiller/fishplot")
devtools::install_github("chrisamiller/fishplot")
library(fishplot)
?fishPlot
vignettes()
vignette()
timepoints=c(0,30,75,150)
frac.table = matrix(
c(100, 45, 00, 00,
02, 00, 00, 00,
02, 00, 02, 01,
98, 00, 95, 40),
ncol=length(timepoints))
frac.table
parents = c(0,1,1,3)
fish = createFishObject(frac.table,parents,timepoints=timepoints)
fish = layoutClones(fish)
fish
fishPlot(fish,shape="spline",title.btm="Sample1",
cex.title=0.5, vlines=c(0,150),
vlab=c("day 0","day 150"))
library(tidyr)
library(dplyr)
library(readr)
clonedata <- read_csv('~/Desktop/testing/clonedata.txt')
clonedata <- read_delim('~/Desktop/testing/clonedata.txt', delim = "/t")
clonedata <- read_delim('~/Desktop/testing/clonedata.txt', delim = "\t")
timedata <- read_delim('~/Desktop/testing/timedata.txt', delim = "\t")
head(clonedata)
tail(clonedata)
?.Call
setwd('./examples/constant-rate/passenger')
getwd()
setwd('~/Dropbox/michor/projets/SIApop/SIApop/examples/constant-rate/passenger')
setwd('~/Dropbox/michor/projects/SIApop/SIApop/examples/constant-rate/passenger')
cat(readLines('./inputdat.txt'), sep = '\n')
getwd()
source('../../../../R/fishplot.R')
library(readr)
library(tidyr)
timedata <- read_csv('timedata.txt')
timedata
View(timedata)
timedata <- read_delim('timedata.txt', delim = "\t")
View(timedata)
tdat <- timedata %>% filter(run == 1)
timedata %>% filter(run == 1)
timedata
timedata %>% filter(run == 1)
library(dplyr)
tdat <- timedata %>% filter(run == 1)
plot.tree(tdat, 0.01)
timedata <- read_delim('timedata.txt', delim = "\t")
tdat <- timedata %>% filter(run == 1)
plot.tree(tdat, 0.01)
tdat <- timedata %>% filter(run == 2)
plot.tree(tdat, 0.01)
plot.tree(tdat, 0.05)
plot.tree(tdat, 0.005)
plot.tree(tdat, 0.01)
timedata %>% filter(run == 2) %>% fishPlotBD(tdat, 0.01)
source('../../../../R/fishplot.R')
source('../../../../R/cloneplot.R')
timedata %>% filter(run == 2) %>% fishPlotBD(tdat, 0.01)
timedata %>% filter(run == 2) %>% fishPlotBD(0.01)
clonedata <- read_delim('clonedata.txt', delim = "\t")
View(clonedata)
clonedata %>% filter(run == 1) %>%
ggplot(aes(x = count_alleles)) + geom_density()
library(ggplot2)
clonedata %>% filter(run == 1) %>%
ggplot(aes(x = count_alleles)) + geom_density()
clonedata %>% filter(run == 1) %>%
ggplot(aes(x = count_alleles)) + geom_density() + scale_x_log10()
clonedata %>%
ggplot(aes(x = count_alleles)) + geom_density() + scale_x_log10() +
facet_wrap(~run)
View(clonedata)
barcode <- timedata %>% filter(unique_id %in% c('a1.a', 'a2.a', 'a3.a', 'a4.a', 'a5.a')) %>%
ggplot(aes(x = count_alleles)) + geom_density() + scale_x_log10() +
facet_wrap(~run)
barcode <- timedata %>% filter(unique_id %in% c('a1.a', 'a2.a', 'a3.a', 'a4.a', 'a5.a'))
barcode %>%
ggplot(aes(x = count_alleles)) + geom_density() + scale_x_log10() +
facet_wrap(~run)
timedata
barcode <- timedata %>% filter(unique_id %in% c('a1.a', 'a2.a', 'a3.a', 'a4.a', 'a5.a'))
barcode %>%
ggplot(aes(x = allelefreq)) + geom_density() + scale_x_log10() +
facet_wrap(~run)
barcode <- timedata %>% filter(unique_id %in% c('a1.a', 'a2.a', 'a3.a', 'a4.a', 'a5.a'))
barcode %>%
ggplot(aes(x = allelefreq)) + geom_histogram() + scale_x_log10() +
facet_wrap(~run)
barcode
barcode <- clonedata %>% filter(unique_id %in% c('a1.a', 'a2.a', 'a3.a', 'a4.a', 'a5.a'))
barcode %>%
ggplot(aes(x = count_alleles)) + geom_histogram() + scale_x_log10() +
facet_wrap(~run)
timedata %>% filter(unique_id %in% c('a1.a', 'a2.a', 'a3.a', 'a4.a', 'a5.a')) %>%
ggplot(aes(x = time, y = allelefreq, colour = unique_id)) +
geom_line() + scale_x_log10() +
facet_wrap(~run)
timedata %>% filter(unique_id %in% c('a1.a', 'a2.a', 'a3.a', 'a4.a', 'a5.a')) %>%
ggplot(aes(x = time, y = allelefreq, colour = unique_id)) +
geom_line() + scale_x_log10() + scale_y_log10()
facet_wrap(~run)
timedata %>% filter(unique_id %in% c('a1.a', 'a2.a', 'a3.a', 'a4.a', 'a5.a')) %>%
ggplot(aes(x = time, y = allelefreq, colour = unique_id)) +
geom_line() + scale_x_log10() + scale_y_log10() +
facet_wrap(~run)
?knitr::opts_chunk
rm(list = ls())
?opts_knit
?Hmist
?hmisc
??hmisc
?rbinom
?rbinom
?rnorm
